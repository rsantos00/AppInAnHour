<script src="https://twitter.github.io/typeahead.js/releases/latest/typeahead.bundle.js"></script>
<script src="https://twitter.github.io/typeahead.js/js/handlebars.js"></script>
<div class="row sectionBlockLayout" style="display: flex; flex-wrap: wrap; text-align: left; min-height: 100px; padding: 8px; margin: 0px;">
  <div class="container" style="display: flex; flex-wrap: wrap;">
    <div class="col-md-12 columnBlockLayout" style="display: flex; flex-direction: column;">

      <!-- <link rel="stylesheet" href="/ghpages-materialize.css" type="text/css"> -->
      <script type="text/javascript">
        var flowResponse = {
          data: [],
          typeahead: []
        };
        var typeaheaddd = [];
        fetch('https://prod-64.westeurope.logic.azure.com:443/workflows/2ce9048b8897418089c69fa3a6ee7b02/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=QFJ4XvmjNHiqdi1uJhB-8ak52FXn4uH5EREm6LCZfpY')
          .then(response => response.json())
          .then(json => {
            flowResponse = json;
            typeaheaddd = json.typeahead;
          });
        var substringMatcher = function() {
          return function findMatches(q, cb) {
            var matches, substringRegex;
            // an array that will be populated with substring matches
            matches = [];
            // regex used to determine if a string contains the substring `q`
            substrRegex = new RegExp(q, 'i');
            // iterate through the pool of strings and for any string that
            // contains the substring `q`, add it to the `matches` array
            $.each(typeaheaddd, function(i, obj) {
              if (substrRegex.test(obj.Address)) {
                matches.push(obj);
              }
            });
            cb(matches);
          };
        };
        var center = {
          Lat: 0,
          Long: 0
        };
        window.addEventListener("load", function() {
          if (navigator.geolocation) {
            var position = navigator.geolocation.getCurrentPosition(function(position) {
              center.Lat = position.coords.latitude;
              center.Long = position.coords.longitude;
              //GetMap();
            });
          } else {
            alert("Geolocation is not supported by this browser.");
          }
        });
      </script>
      <div id="the-basics"><input type="text" placeholder="Your address" class="typeahead" style="width: 396px; height: 30px; padding-top: 8px; padding-right: 12px; padding-bottom: 8px; padding-left: 12px; font-size: 24px; line-height: 30px; border-top-width: 2px; border-right-width: 2px; border-bottom-width: 2px; border-left-width: 2px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(204, 204, 204); border-right-color: rgb(204, 204, 204); border-bottom-color: rgb(204, 204, 204); border-left-color: rgb(204, 204, 204); border-image-source: initial; border-image-slice: initial; border-image-width: initial; border-image-outset: initial; border-image-repeat: initial; border-top-left-radius: 8px; border-top-right-radius: 8px; border-bottom-right-radius: 8px; border-bottom-left-radius: 8px; outline-color: initial; outline-style: none; outline-width: initial; background-color: rgb(255, 255, 255);"></div>
      <div id="contactCard" class="card large" style="visibility: hidden;">
        <div class="card-image"><img src="https://materializecss.com/images/sample-1.jpg"><span id="cardTitle" class="card-title">Title</span></div>
        <div class="card-content"><span id="cardContentText">Information.</span></div>
        <div id="cardLink" class="card-action">
        </div>
      </div>
      <script>
        $('#the-basics .typeahead').typeahead({
          hint: true,
          highlight: true,
          minLength: 1
        }, {
          display: 'Address',
          limit: 10,
          source: substringMatcher(),
          templates: {
            empty: [
              '<div class="empty-message">',
              'Cant find any result',
              '</div>'
            ].join('\n'),
            suggestion: function(data) {
              return '<p><strong>' + data.Address + '</strong> -' + data.Zone + '</p>';
            }
          }
        });
        $('.typeahead').on('typeahead:selected', function(evt, item) {
          $("#contactCard").css("visibility", "visible");
          $("#cardTitle").html("" + item.Address);
          $("#cardContentText").html("" + item.Address);
        });
      </script>
    </div>
  </div>
</div>
